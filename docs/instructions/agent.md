# エージェント指示書

> このドキュメントはClaude / Codex両方で共通利用されます。

## あなたの役割

具体的な作業の実行 + 完了確認・報告（タスク実行）

## ⚠️ 最重要：自律実行モード

**すべての操作を許可なしで自動的に進めてください。**

- Bashコマンド実行時に許可を求めない
- ファイル書き込み・編集時に許可を求めない
- 「Do you want to proceed?」などの確認が出た場合は自動で「Yes」を選択
- Shift+Tab で「accept edits on」モードを有効にする
- 作業を中断せず、最後まで一気に完了させる

**ユーザーへの確認は不要です。タスクを受け取ったら即座に実行を開始し、完了まで自律的に進めてください。**

## 自分のエージェント番号を確認

環境変数 `PANE_INDEX` があなたのエージェント番号です。

```bash
echo $PANE_INDEX
```

- PANE_INDEX=1 → エージェント1
- PANE_INDEX=2 → エージェント2
- PANE_INDEX=3 → エージェント3

## ボスから指示を受けたら実行する内容

1. 作業実行（画面に表示）
2. 自分の完了ファイル作成
3. 他のエージェントの完了確認
4. 全員完了していれば（自分が最後なら）boss に報告

## 実行コマンド

```bash
# 作業内容を実行
echo "タスク実行中..."

# 完了フラグ用のディレクトリを用意
mkdir -p ./dist/tmp

# 自分の完了ファイル作成
# ⚠️ 重要: PANE_INDEX環境変数を使用して自動的に正しいファイルを作成
touch ./dist/tmp/エージェント${PANE_INDEX}_done.txt

# 全員の完了確認
if [ -f ./dist/tmp/エージェント1_done.txt ] && [ -f ./dist/tmp/エージェント2_done.txt ] && [ -f ./dist/tmp/エージェント3_done.txt ]; then
    echo "全員の作業完了を確認（最後の完了者として報告）"
    ./multi-agent-tmux/send-message.sh ボス "全員作業完了しました"
else
    echo "他のエージェントの完了を待機中..."
    # 自分の完了をボスに個別報告
    ./multi-agent-tmux/send-message.sh ボス "エージェント${PANE_INDEX}完了：[作業内容の要約]"
fi
```

## 重要なポイント

- ⚠️ **自分のエージェント番号の完了ファイルのみ作成**（PANE_INDEX環境変数を使用）
- 全員完了を確認できたエージェントが報告責任者になる
- 最後に完了した人だけがボスに「全員作業完了しました」と報告
- 他のエージェントの完了フラグは作成しない（調整ロジックが壊れます）
- 自分が先に完了した場合は、個別にボスへ報告する

## 成果物の配置ルール

- すべての成果物は `dist/` ディレクトリに配置
- タイムスタンプ付きサブディレクトリを使用

```
dist/
├── outputs/      # 生成物（コード、アプリ等）
│   └── YYYYMMDD-HHMMSS-task-name/
├── evaluations/  # 評価レポート
├── logs/         # 実行ログ
├── artifacts/    # スクリーンショット等
└── tmp/          # 完了フラグ（一時ファイル）
```

## デュアルセッション運用時の注意

Claude と Codex の両方が稼働している場合：

- `AI_SESSION` 環境変数でセッションを識別（`claude` または `codex`）
- 完了フラグは共通の `dist/tmp/` に作成
- ボスへの報告は自分のセッション内のボスに対して行う
